# @author Ryotaro Hinata 2019

angle unit: degree

controller:
  control model: humanBody
  input: torque
  # driven: mix
  driven: flow
  trigger: check foot contact

  default:
    control method:
      inverse dynamics controller: fullDynamicsController

      operational space controller: decomposeEndEffectorAcceleration
      motion controller: mixedGeneralizedMomentum

      momentum controller: centroidalVrpMomentum
      force controller: centroidalDcmDistribution
      torque controller: mixedmixedOpt

    desired value generator:
      DCM: {name: CP}
      base rotation: {name: CP}
      control node translation:
        RLEGEE: {num: 0, name: CP}
        LLEGEE: {num: 0, name: CP}
        RARMEE: {num: 0, name: CP}
        LARMEE: {num: 0, name: CP}
      control node rotation:
        RLEGEE: {num: 0, name: CP}
        LLEGEE: {num: 0, name: CP}
        RARMEE: {num: 0, name: CP}
        LARMEE: {num: 0, name: CP}
        TORSO3: {num: 0, name: BaseTrack}
      external wrench: {name: step}

    feedback controller:
      CoM: dcmControl
      
    KX: 3.e+2
    # KpC: 1.e+2
    # KdC: 5.e+1

    KpwB: 3.e+2
    KdwB: 5.e+1

    Kpv:
      RLEGEE: 3.e+2
      LLEGEE: 3.e+2
    Kdv:
      RLEGEE: 5.e+1
      LLEGEE: 5.e+1
    Kpw:
      RLEGEE: 3.e+2
      LLEGEE: 3.e+2
      TORSO3: 5.e+2
    Kdw:
      RLEGEE: 5.e+1
      LLEGEE: 5.e+1
      TORSO3: 5.e+1

    KDth: 1.e+3
    # KPth: 3.e+2

    # KDlC: 1.e+3

    # Bm:
    #   TORSO3: [0, 0, 0, 1, 1, 1]


  sequence:
    -
      -
        twf: 1.0
        Bc:
          RLEGEE: [1, 1, 1, 1, 1, 1]
          LLEGEE: [1, 1, 1, 1, 1, 1]

      -
        twf: 2.0
        control method:
          ext motion controller: true
          motion controller: RAA_fullBase
          ext momentum controller: true
          momentum controller: vrp_MobilityCompensation

          torque controller: mixed
        KdwB: 0
      -
        twf: 2.0
        rXf: [0, 0.1, 0]

      -
        twf: 1.0
        Bc:
          RLEGEE: [0, 0, 0, 0, 0, 0]
          LLEGEE: [1, 1, 1, 1, 1, 1]
          
        Bm:
          RLEGEE: [1, 1, 1, 1, 1, 1]
          LLEGEE: [0, 0, 0, 0, 0, 0]
        rf:
          RLEGEE: [0., 0., 0.05]

      -
        twf: 1.0

      -
        twf: 1.5
        control method:
          # ext motion controller: true
          # motion controller: RAA_RNS
          motion controller: RAA_noDistribution
          # motion controller: mixedAccelerationSynergy
          ext momentum controller: true
          momentum controller: vrp_RNS

        KX: 3.e+1
          
        KpwB: 3.e+1
        KdwB: 5.e+0

        KDlC: 1.e+1

        Bm:
          RLEGEE: [0, 0, 0, 0, 0, 0]
          LLEGEE: [0, 0, 0, 0, 0, 0]
          TORSO3: [0, 0, 0, 0, 0, 0]

        xiBf: [0., 0., -30.]

      -
        twf: 1.5

        xiBf: [0., 0., 0.]

      -
        twf: 1.5

        xiBf: [0., 0., -20.]

      -
        twf: 1.5

        xiBf: [0., 0., 0.]

      -
        twf: 1.5

        xiBf: [0., 0., -20.]

      -
        twf: 1.5

        xiBf: [0., 0., 0.]

      -
        twf: 1.5

        xiBf: [0., 0., -20.]

      -
        twf: 1.5

        xiBf: [0., 0., 0.]

      -
        twf: 1.5

        # Bm:
        #   RLEGEE: [1, 1, 1, 1, 1, 1]
        #   LLEGEE: [0, 0, 0, 0, 0, 0]
        # rf:
        #   RLEGEE: [0., -0.039, 0.]
