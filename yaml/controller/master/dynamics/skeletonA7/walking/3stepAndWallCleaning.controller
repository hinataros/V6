# @author Sho Miyahara 2018

angle unit: degree

controller:
  control model: skeletonA7SF
  input: torque
  driven: mix
  trigger: check contact

  default:
    control method:
      inverse dynamics controller: fullDynamicsController
      operational space controller: decomposeEndEffectorAcceleration
      motion controller: mixedGeneralizedMomentum
      force controller: centroidalEcmpDistribution
      momentum controller: centroidalDcmMomentum
      # force controller: centroidalDistribution
      # momentum controller: centroidalMomentum
      torque controller: mixedOpt
      # torque controller: mixedmixedOpt

    desired value generator:
      DCM: {name: HTWalking}
      base rotation: {num: 2, name: CP}
      control node translation:
        RLEGEE: {num: 0, name: swing}
        LLEGEE: {num: 0, name: swing}
        #
        RARMEE: {num: 1, name: CPabs}
      control node rotation:
        RARMEE: {num: 1, name: CPabs}
      control node force:
        RARMEE: {num: 1, name: CP}

    KX: 3.e+2
    KpwB: 3.e+2
    KdwB: 5.e+1

    Kpv:
      RLEGEE: 5.e+2
      LLEGEE: 5.e+2
      #
      RARMEE: 3.e+2
    Kpw:
      RLEGEE: 5.e+2
      LLEGEE: 5.e+2
      #
      RARMEE: 3.e+3
    Kdv:
      RLEGEE: 5.e+1
      LLEGEE: 5.e+1
      #
      RARMEE: 1.e+1
    Kdw:
      RLEGEE: 5.e+1
      LLEGEE: 5.e+1
      #
      RARMEE: 1.e+1

    # KDlC: 1.e+1
    # KDth: 1.e+2
    kDth: &kDthH 5.e+0
    # kDth: &kDthH 2.e+1

    kDth: &kDthHr 3.e+1
    kDth: &kDthHl 3.e+1

    KDth:
      [0.,0.,0.,0.,0.,0., 0.,0.,0.,0.,0.,0.,
      *kDthHr, *kDthHr, *kDthHr, *kDthHr, *kDthHr, *kDthHr, *kDthHr,
      *kDthHl, *kDthHl, *kDthHl, *kDthHl, *kDthHl, *kDthHl, *kDthHl]

    # kthHinit: &kthHinit 0.
    kthHinit: &kthHinit 1.e+2
    Kthinit:
      [0.,0.,0.,0.,0.,0., 0.,0.,0.,0.,0.,0.,
      *kthHinit, *kthHinit, *kthHinit, *kthHinit, *kthHinit, *kthHinit, *kthHinit,
      *kthHinit, *kthHinit, *kthHinit, *kthHinit, *kthHinit, *kthHinit, *kthHinit]
    Bc: &ds
      RLEGEE: [1, 1, 1, 1, 1, 1]
      LLEGEE: [1, 1, 1, 1, 1, 1]
    Bm: &zs
      RLEGEE: [0, 0, 0, 0, 0, 0]
      LLEGEE: [0, 0, 0, 0, 0, 0]

  state:
    -
      control method:
        inverse dynamics controller: default
      Bc:
        RLEGEE: [0, 0, 0, 0, 0, 0]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        RARMEE: [0, 0, 0, 0, 0, 0]
      Bm:
        RLEGEE: [0, 0, 0, 0, 0, 0]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        RARMEE: [0, 0, 0, 0, 0, 0]
    -
      control method:
        inverse dynamics controller: fullDynamicsController
        force controller: centroidalEcmpDistribution
      Bc:
        RLEGEE: [1, 1, 1, 1, 1, 1]
        LLEGEE: [1, 1, 1, 1, 1, 1]
        # RARMEE: [0, 0, 0, 0, 0, 0]
      Bm:
        RLEGEE: [0, 0, 0, 0, 0, 0]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        # RARMEE: [0, 0, 0, 0, 0, 0]
    -
      control method:
        inverse dynamics controller: fullDynamicsController
        force controller: centroidalEcmpDistribution
      Bc: &ls
        RLEGEE: [0, 0, 0, 0, 0, 0]
        LLEGEE: [1, 1, 1, 1, 1, 1]
        # RARMEE: [0, 0, 0, 0, 0, 0]
      Bm: &rs
        RLEGEE: [1, 1, 1, 1, 1, 1]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        # RARMEE: [0, 0, 0, 0, 0, 0]
    -
      control method:
        inverse dynamics controller: fullDynamicsController
        force controller: centroidalEcmpDistribution
      Bc:
        RLEGEE: [1, 1, 1, 1, 1, 1]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        # RARMEE: [0, 0, 0, 0, 0, 0]
      Bm:
        RLEGEE: [0, 0, 0, 0, 0, 0]
        LLEGEE: [1, 1, 1, 1, 1, 1]
        # RARMEE: [0, 0, 0, 0, 0, 0]
    -
      control method:
        inverse dynamics controller: fullDynamicsController
        force controller: handWrenchControlAndCentroidalEcmpDistribution
      Bc:
        RLEGEE: [1, 1, 1, 1, 1, 1]
        LLEGEE: [1, 1, 1, 1, 1, 1]
        RARMEE: [0, 1, 0, 1, 0, 1]
      Bm:
        RLEGEE: [0, 0, 0, 0, 0, 0]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        RARMEE: [1, 0, 1, 0, 1, 0]
    -
      control method:
        inverse dynamics controller: fullDynamicsController
        force controller: handWrenchControlAndCentroidalEcmpDistribution
      Bc:
        RLEGEE: [0, 0, 0, 0, 0, 0]
        LLEGEE: [1, 1, 1, 1, 1, 1]
        RARMEE: [0, 1, 0, 1, 0, 1]
      Bm:
        RLEGEE: [1, 1, 1, 1, 1, 1]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        RARMEE: [1, 0, 1, 0, 1, 0]
    -
      control method:
        inverse dynamics controller: fullDynamicsController
        force controller: handWrenchControlAndCentroidalEcmpDistribution
      Bc:
        RLEGEE: [1, 1, 1, 1, 1, 1]
        LLEGEE: [0, 0, 0, 0, 0, 0]
        RARMEE: [0, 1, 0, 1, 0, 1]
      Bm:
        RLEGEE: [0, 0, 0, 0, 0, 0]    toe: 0.025
    heel: -0.015

    tstab: &tstab 1.

    height: &height 0.02

    length: &steplength1 0.08
    length: &steplength2 0.16
    length: &steplength3 0.24

  foot print:
    rfabs: &footPrint1
      LLEGEE: [*steplength1, 0.039, *height]
    rfabs: &footPrint2
      RLEGEE: [*steplength2, -0.039, *height]
    rfabs: &footPrint3
      LLEGEE: [*steplength3, 0.039, *height]
    rfabs: &footPrint4
      RLEGEE: [*steplength3, -0.039, *height]
  # ****************************************************************

  sequence:
    -
      -
        twf: *tstab
      -
        twf: *tinitial
      -
        twf: *tswingleg
        Bc: *rs
        Bm: *ls
        rfabs: *footPrint1
      -
        twf: *tds
      # 1 step
      -
        twf: *tswingleg
        Bc: *ls
        Bm: *rs
        rfabs: *footPrint2
      -
        twf: *tds
      # 2 step
      -
        twf: *tswingleg
        Bc: *rs
        Bm: *ls
        rfabs: *footPrint3
      -
        twf: *tds
      # 3 step
      -
        twf: *tswingleg
        Bc: *ls
        Bm: *rs
        rfabs: *footPrint4
      -
        twf: *tds
        rtd:
          RLEGEE: [*steplength3, -0.039, -0.01]
    -
      -
        twf: *tstab
      -
        twf: 1.
      -
        twf: 1.
        Bm:
          RARMEE: [1, 1, 1, 1, 1, 1]
        rfabs:
          RARMEE: [0.1, -0.1995, 0.4]
        xifabs:
          RARMEE: [-90., 0., -90.]
      -
        twf: 0.5
        control method:
          # internal force controller: m_internalDistribution
          force controller: handWrenchControlAndCentroidalEcmpDistribution
        Bc:
          RARMEE: [0, 1, 0, 1, 0, 1]
        Bm:
          RARMEE: [1, 0, 1, 0, 1, 0]
        rfabs:
          RARMEE: [0.2, -0.1995, 0.45]
        ff:
          RARMEE: [0., 2., 0.]
      -
        twf: 1.
        rfabs:
          RARMEE: [0.25, -0.1995, 0.35]
      -
        twf: .5
        rfabs:
          RARMEE: [0.3, -0.1995, 0.4]
      -
        twf: .5
        ff:
          RARMEE: [0., 0., 0.]
      -
        twf: 2.
        control method:
          force controller: centroidalEcmpDistribution
        Bc:
          RARMEE: [0, 0, 0, 0, 0, 0]
        Bm:
          RARMEE: [1, 1, 1, 1, 1, 1]
        rfabs:
          RARMEE: [0.3, -0.0995, 0.2]
        xifabs:
          RARMEE: [0., 0., 90.]
    -
      -
        twf: *tstab
      -
        twf: 2.
        xiBf: [-20., 0., 0.]
      -
        twf: 3.
      -
        twf: 1.
        xiBf: [0., 0., 0.]
